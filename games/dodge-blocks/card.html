<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Dodge Blocks | GlassPlay</title>

<style>
body {
    margin: 0;
    background: linear-gradient(135deg,#0f2027,#203a43,#2c5364);
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    font-family: Arial, sans-serif;
    color: white;
}

/* كارت اللعبة */
.game-card {
    width: 380px;
    background: rgba(255,255,255,0.1);
    backdrop-filter: blur(14px);
    border-radius: 24px;
    padding: 22px;
    box-shadow: 0 20px 45px rgba(0,0,0,0.4);
    text-align: center;
}

/* أزرار */
button {
    background: #00eaff;
    border: none;
    padding: 12px 34px;
    border-radius: 30px;
    font-size: 16px;
    cursor: pointer;
    margin-top: 15px;
    transition: 0.2s;
}
button:hover {
    transform: scale(1.05);
}

/* شاشة اللعبة */
#gameWrapper {
    display: none;
    position: relative;
    margin-top: 15px;
}

canvas {
    border-radius: 18px;
    background: rgba(255,255,255,0.08);
}

/* السكور */
#score {
    position: absolute;
    top: 10px;
    left: 15px;
    font-size: 18px;
}

/* Game Over */
#gameOver {
    display: none;
    margin-top: 10px;
}
</style>
</head>

<body>

<div class="game-card">
    <h2>Dodge Blocks</h2>
    <p>تفادى العوائق لأطول وقت ممكن</p>

    <button id="startBtn" onclick="startGame()">Play</button>

    <div id="gameWrapper">
        <div id="score">Score: 0</div>
        <canvas id="game" width="340" height="520"></canvas>
    </div>

    <div id="gameOver">
        <h3>Game Over</h3>
        <p id="finalScore"></p>
        <button onclick="restart()">Restart</button>
    </div>
</div>

<!-- صوت -->
<audio id="hitSound" src="https://assets.mixkit.co/sfx/preview/mixkit-arcade-retro-game-over-213.wav"></audio>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const scoreEl = document.getElementById("score");
const hitSound = document.getElementById("hitSound");
const gameOverBox = document.getElementById("gameOver");
const finalScore = document.getElementById("finalScore");

let player, blocks, score, running, spawnTimer;

// بدء اللعبة
function startGame() {
    document.getElementById("startBtn").style.display = "none";
    document.getElementById("gameWrapper").style.display = "block";
    gameOverBox.style.display = "none";

    player = { x: 170, y: 460, r: 14 };
    blocks = [];
    score = 0;
    running = true;

    spawnTimer = setInterval(spawnBlock, 900);
    loop();
}

// تحكم بالماوس
document.addEventListener("mousemove", e => {
    const rect = canvas.getBoundingClientRect();
    player.x = e.clientX - rect.left;
});

// إنشاء العوائق
function spawnBlock() {
    if (!running) return;
    blocks.push({
        x: Math.random() * (canvas.width - 30),
        y: -30,
        s: 30,
        v: 3 + Math.random() * 2
    });
}

// رسم اللاعب
function drawPlayer() {
    ctx.beginPath();
    ctx.arc(player.x, player.y, player.r, 0, Math.PI * 2);
    ctx.fillStyle = "#00eaff";
    ctx.shadowBlur = 15;
    ctx.shadowColor = "#00eaff";
    ctx.fill();
    ctx.shadowBlur = 0;
}

// رسم العوائق
function drawBlocks() {
    ctx.fillStyle = "#ff5f5f";
    blocks.forEach(b => ctx.fillRect(b.x, b.y, b.s, b.s));
}

// نهاية اللعبة
function endGame() {
    running = false;
    clearInterval(spawnTimer);
    hitSound.play();

    finalScore.textContent = "Score: " + score;
    gameOverBox.style.display = "block";
}

// إعادة التشغيل
function restart() {
    startGame();
}

// اللوب
function loop() {
    if (!running) return;

    ctx.clearRect(0, 0, canvas.width, canvas.height);
    drawPlayer();
    drawBlocks();

    blocks.forEach(b => {
        b.y += b.v;

        if (
            b.x < player.x + player.r &&
            b.x + b.s > player.x - player.r &&
            b.y < player.y + player.r &&
            b.y + b.s > player.y - player.r
        ) {
            endGame();
        }
    });

    blocks = blocks.filter(b => b.y < canvas.height + 40);
    score++;
    scoreEl.textContent = "Score: " + score;

    requestAnimationFrame(loop);
}
</script>

</body>
</html>
